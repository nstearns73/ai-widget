<script>
  const WORKER_BASE = "https://square-fog-677a.swaydargument.workers.dev";
  const WORKER_CHAT_URL = WORKER_BASE + "/chat";
  const WORKER_HEALTH_URL = WORKER_BASE + "/health";

  const btn = document.getElementById("b");
  const out = document.getElementById("out");
  const input = document.getElementById("p");

  // Add a quick health-test button
  const testBtn = document.createElement("button");
  testBtn.textContent = "Test /health";
  testBtn.style.marginLeft = "8px";
  btn.after(testBtn);

  testBtn.onclick = async () => {
    out.textContent = "Testing /health…";
    try {
      const r = await fetch(WORKER_HEALTH_URL, { method: "GET" });
      const text = await r.text();
      out.textContent = "HEALTH HTTP " + r.status + "\n\n" + text;
    } catch (e) {
      out.textContent = "HEALTH failed:\n" + String(e);
    }
  };

  btn.onclick = async () => {
    out.textContent = "Thinking…";
    try {
      const r = await fetch(WORKER_CHAT_URL, {
        method: "POST",
        headers: {"Content-Type":"application/json"},
        body: JSON.stringify({ prompt: input.value })
      });

      const text = await r.text();
      out.textContent = "CHAT HTTP " + r.status + "\n\n" + text;
    } catch (e) {
      out.textContent = "CHAT failed:\n" + String(e);
    }
  };
</script>
